{% extends "base.html" %}
{% block content %}

<div class="card card-soft p-4">
  <h4>Actualizar Pedido</h4>

  <form method="POST">
    {% csrf_token %}

    <!-- USUARIO -->
    <div class="mb-3">
      <label class="form-label">Usuario</label>
      <select name="usuario" class="form-control" required>
        {% for u in usuarios %}
          <option value="{{ u.id_usuario }}"
            {% if u.id_usuario == pedido.usuario.id_usuario %}selected{% endif %}>
            {{ u.nombre }} {{ u.apellido }}
          </option>
        {% endfor %}
      </select>
    </div>

    <!-- PRODUCTO -->
    <div class="mb-3">
      <label class="form-label">Producto</label>
      <select name="producto" class="form-control" required>
        {% for p in productos %}
          <option value="{{ p.id_producto }}"
            {% if p.id_producto == pedido.producto.id_producto %}selected{% endif %}>
            {{ p.nombre }}
          </option>
        {% endfor %}
      </select>
    </div>

    <!-- VENDEDOR -->
    <div class="mb-3">
      <label class="form-label">Vendedor</label>
      <select name="vendedor" class="form-control" required>
        {% for v in vendedores %}
          <option value="{{ v.id_vendedor }}"
            {% if v.id_vendedor == pedido.vendedor.id_vendedor %}selected{% endif %}>
            {{ v.nombre }}
          </option>
        {% endfor %}
      </select>
    </div>

    <!-- TRANSACCIÓN -->
    <div class="mb-3">
      <label class="form-label">Transacción</label>
      <select name="id_transaccion" class="form-control" required>
        {% for t in transacciones %}
          <option value="{{ t.id_transaccion }}"
            {% if t.id_transaccion == pedido.id_transaccion.id_transaccion %}selected{% endif %}>
            {{ t.metodo_pago }} — {{ t.fecha_transaccion }}
          </option>
        {% endfor %}
      </select>
    </div>

    <!-- TOTAL -->
    <div class="mb-3">
      <label class="form-label">Total del Pedido</label>
      <input type="number" step="0.01" name="total" class="form-control"
        value="{{ pedido.total }}" required>
    </div>

    <!-- ESTADO -->
    <div class="mb-3">
      <label class="form-label">Estado</label>
      <select name="estado" class="form-control" required>
        <option value="pendiente"  {% if pedido.estado == "pendiente" %}selected{% endif %}>Pendiente</option>
        <option value="enviado"    {% if pedido.estado == "enviado" %}selected{% endif %}>Enviado</option>
        <option value="entregado"  {% if pedido.estado == "entregado" %}selected{% endif %}>Entregado</option>
      </select>
    </div>

    <!-- DIRECCIÓN -->
    <div class="mb-3">
      <label class="form-label">Dirección de Envío</label>
      <input type="text" name="direccion_envio" class="form-control"
        value="{{ pedido.direccion_envio }}" required>
    </div>

    <!-- PAÍS -->
    <div class="mb-3">
      <label class="form-label">País de Envío</label>
      <input type="text" name="pais_envio" class="form-control"
        value="{{ pedido.pais_envio }}" required>
    </div>

    <button class="btn btn-primary mt-2">Guardar</button>
    <a href="{% url 'ver_pedido' %}" class="btn btn-secondary mt-2">Cancelar</a>

  </form>
</div>

{% endblock %}
